(function main() {	var doc = app.activeDocument,		root = Folder.desktop,		selection = [],		filename,		filename_count = {},		o, i	// Save the current selection because #getExporter	// will hide all layers, causing us to lose the selection	for (i = 0; i < doc.selection.length; i++) {		selection.push(doc.selection[i])	}	var exporter = getExporter(root)	if (typeof(exporter) === "undefined") {		return	}	for (i = 0; i < selection.length; i++) {		o = selection[i]		filename = o.name		if (filename === "") { // When shapes are created e.g. <Rectangle>			filename = doc.name		}		if (filename_count.hasOwnProperty(filename)) {			filename_count[filename]++			filename = filename + "-" + filename_count[filename]		} else {			filename_count[filename] = 0		}		exporter.write(o, filename)	}	exporter.done()		// Restore selection	for (i = 0; i < selection.length; i++) {		o = selection[i]		o.selected = true	}})()